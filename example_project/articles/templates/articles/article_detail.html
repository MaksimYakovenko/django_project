{% extends "base.html" %}
{% block title %}{{ article.title }}{% endblock %}
{% block content %}
<h1>{{ article.title }}</h1>
<p>Автор:
  {% if article.user %}
    {{ article.user.username }}
  {% else %}
    {{ article.author }}
  {% endif %}
  | {{ article.publication_date }}
</p>
<p>Категорія: <i class="{{ article.category.icon }}"></i> {{ article.category.title }}</p>
{% if article.image %}<p><img src="{{ article.image }}" width="480"></p>{% endif %}
<p>{{ article.text }}</p>

<h2>Коментарі</h2>
<ul>
  {% for c in article.comments.all %}
    <li>
      <b>
      {% if c.user %}
        {{ c.user.username }}
      {% else %}
        {{ c.author }}
      {% endif %}
      </b>:
      {{ c.text }} ({{ c.publication_date }})
      {% if user.is_authenticated %}
        {% if c.user == user or is_moderator %}
          - <a href="{% url 'articles:edit_comment' c.id %}">Редагувати</a>
          - <a href="{% url 'articles:delete_comment' c.id %}">Видалити</a>
        {% endif %}
      {% endif %}
    </li>
  {% empty %}
    <li>Поки немає коментарів.</li>
  {% endfor %}
</ul>

<h3>Додати коментар</h3>
<form method="post" action="{% url 'articles:comment' article.pk %}">
  {% csrf_token %}
  {% if user.is_authenticated %}
    <p>Текст: <textarea name="text" required></textarea></p>
  {% else %}
    <p>Ім’я: <input name="author_name" required></p>
    <p>Текст: <textarea name="text" required></textarea></p>
  {% endif %}
  <button type="submit">Надіслати</button>
</form>
{% endblock %}
